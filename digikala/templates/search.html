{% extends 'base.html' %}
{% block content %}
{% load humanize %}
<header class="bg-dark py-5">
	<div class="container px-4 px-lg-5 my-5">
		<div class="text-center text-white">
			<h1 class="display-4 fw-bolder">جستجو</h1>
		</div>
	</div>
</header>
<div class="container">
	<div class="row">
		<center>
			<div class="col-10 p-4">
				<div class="card">
					<div class="card-header">
						جستجو
					</div>
					<div class="card-body p-4">
						<form method="POST" action="{% url 'search' %}">
							{% csrf_token %}
							<input type="text" class="form-control" placeholder="نام محصول را وارد کنید"
								name="searchName">
							<button type="submit" class="btn btn-primary mt-4">جستجو</button>
						</form>
					</div>
					{% if has_searched %}
					{% if searchName %}
					{% if searchProducts %}
					<div class="py-1">
						<div class="container px-4 px-lg-5">
							<div class="row gx-4 gx-lg-4 row-cols-4 row-cols-md-4 row-cols-xl-3 justify-content-center">
								{% for product in searchProducts %}
								<div class="col mb-5">
									<div class="card h-100">
										{% if product.quantity > 1 %}
										<div class="badge bg-dark text-white position-absolute"
											style="top: 0.5rem; right: 0.5rem">موجود
										</div>
										{% elif product.quantity == 1 %}
										<div class="badge bg-dark text-white position-absolute"
											style="top: 0.5rem; right: 0.5rem">۱ عدد
											باقیمانده</div>
										{% else %}
										<div class="badge bg-dark text-white position-absolute"
											style="top: 0.5rem; right: 0.5rem">ناموجود
										</div>
										{% endif %}

										<img class="card-img-top p-4" src="{{product.product_image.url}}"
											alt="{{product.product_name}}" />
										<div class="card-body text-center">
											<h5 class="fw-bolder">{{product.product_name}}</h5>
											<p>دسته بندی: {{product.product_category}}</p>
											<div class="d-flex justify-content-center small text-warning mb-2">
												{% for _ in ""|ljust:product.star|make_list %}
												<div class="bi-star-fill"></div>
												{% endfor %}
											</div>
											<p {% if product.is_sale %} class="is_sale" {% endif %}>
												{{product.product_price | intcomma}}تومان</p>

											{% if product.is_sale %}
											<p>{{product.sale_price | intcomma}} تومان</p>
											{% endif %}
										</div>
										<div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
											<div class="text-center">
												<a class="btn btn-outline-dark mt-auto"
													href="{% url 'product' product.id %}">مشاهده
													محصول</a>
											</div>
										</div>
									</div>
								</div>
								{% endfor %}
							</div>
						</div>
					</div>
					{% else %}
					<div class="alert alert-info text-center py-4">
						<i class="bi bi-search"></i>
						محصولی با عنوان "{{searchName}}" یافت نشد
					</div>
					{% endif %}
					{% else %}
					<div class="alert alert-info text-center py-4">
						<i class="bi bi-search"></i>
						هیچ عبارتی برای جستجو وارد نکرده اید!
					</div>
					{% endif %}
					{% endif %}

				</div>
			</div>
		</center>
	</div>
</div>
{% endblock %}